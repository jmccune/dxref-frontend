## OBJECT SPEC ##

//VALIDATION NOTES:
//-- validation is an important part of the building/processing of ObjectSpecifications
//
// 	(1) Validation Order
//		+ Validation is done on FIELDS first then OBJECT validation is done.
//		+   (e.g. we will tell you that the x coordinate should be a number before 
//			  we will tell you that the x & y values make a radius that is too small)
//		
//	(2) Validation functions should be written so that
//		they return TRUE (for passes) or FALSE/STRING for errors.
//		+ FALSE means invalid (no reason given)
//		+ A String result means invalid and the reason given is in the string.
//
//  (3) Validation functions are given the following arguments/information
//		
//		FIELD VALIDATORS:
//			
//			validationFunction(fieldName, value, required, fieldSpec, objectContext, otherContext)
//	
//			+ fieldName = which field is being evaluated (by name)
//			+ value = the value of said field.
//		    + required = whether the value is REQUIRED  (e.g. can we leave it empty)
//			+ objectContext = the OBJECT information -- which is NOT guaranteed to be wholly consistent/valid
//				 however this allows us to know that the user has already chosen other fields
//				 that may affect this field  (e.g. use fuzzy logic, add non-standard colors, etc)
//			+ otherContext = sometimes the field itself and/or the user may have passed additional context...
//
//			RETURNS AN ARRAY OF REASONS THAT THE FIELD IS NOT VALID.
//			(An empty array means that the field is valid.)
//




Object Specification: {
	
	_meta: <MetaSpecification>,
	<fieldName>: <fieldSpecification>,
	<fieldName>: <fieldSpecification>,
	<fieldName>: <fieldSpecification>,
	...
	
}



MetaSpecification: {
	doValidation: true | false						// Should we validate the object  (DEFAULT: TRUE)
													//(see validation notes above)
	objectValidators: [ <FnSpec>, <FnSpec>, ... ]	// Validators which validate more than just one field.
													// (e.g. that the x+y values were outside a limiting radius)

	requiredFields: [ <fieldName:string>, <fieldName:string>, ...]
	argumentOrder: [ <fieldName:string>, <fieldName:string>, ...]
	...

	allowUnspecfiedFields: true | false;   	// Should validation allow unspecified fields (DEFAULT: TRUE)
}


FieldSpecification: {
	fieldName: <string>   						      **REQUIRED **  // Self descriptive name
	type:  <FieldType>    							**REQUIRED**   


	_getReasonsNotValidFn: **Specialized Function** that uses the validators if present.   ** AUTOGENERATED**
	required: true | false | <FnSpec>			 // Defaults to false

	--- OPTIONAL w/DEFAULTS ---					 // NOTE:  Defaults may NOT be explicitly represented in the data.

	editable: true | false | <FnSpec>            // Defaults to true
	displayable:  true | false | <FnSpec>		 // Defaults to true (except for ID type-- which defaults to false)
		
	collectionElementType: <FieldType> | <FnSpec> 	 // An element or a function that validates each element
	

	--- OPTIONAL --- 

	defaultValue: <defaultValue: see type field> // Default value the field is assigned if not give one.
	choices: <choicesSpec> 						 // The choices for this object.

	label: <string> 							 // The name to use when displaying the field.   
	format: <FormatSpecification>

	
	reasonValidators: [ <FnSpec>, <FnSpec>, ..] // Custom validators used by validation fn "_getReasonsNotValidFn"
	validatorFnContext: <ObjectMap>				// keyed map that allows parameters/context to be given to the validators
												// (so that the same function may be used with different contexts)
}



FieldType:	<string: from field-types.js>

DynamicFunctionSpec: {
	fn: fnSpec
	frequency: <number> | 'ONCE' | 'EVERY' | ... //   Invoke it every N seconds (if N is a number)
												 //   ONCE implies that the function is queried once
												 //   EVERY implies that it is invoked every time we
												 //		need to know the answer to the question.
												 //	  [DEFAULT is ONCE]
}


ChoicesSpec: {
	values:  <Set of choices: Map or Array | DynamicFunctionSpec> 	 // The choices the user is allowed to give.
	openclosed:  'OPEN' | 'CLOSED' | 			// OPEN if the user add more choices to the given set above, CLOSED if a closed set.
						<FnSpec>				// Function specifies a validation for new choices...
}






FnSpec:  <string> | <function>                 // If a string, the system uses dependency injection where 
											   // it is assumed that there is a method with the given name that
											   // maps to a function.